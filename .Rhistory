c(10, 12, 19, 21,  3),
c(11, 18, 25,  2,  9))
y_train = matrix(c(1, 1, -1, 1, -1), 5,1)
XStar = diag(5)
XStar[1, 1] = 1
XStar[2, 2] = 2
XStar[3, 3] = 3
XStar[4, 4] = 4
XStar[5,5] = 5
#or
X1 = rbind(c(3,1), c(3,-1), c(5,1), c(5,-1))
X2 = rbind(c(1,0), c(0,1), c(0,-1), c(-1,0))
X_train = rbind(X1,X2)
y_train = matrix(c(1,1,1,1,-1,-1,-1,-1), 8, 1)
XStar = diag(8)
X_test = rbind(c(2,1), c(2,-1), c(6,1), c(6,-1),
c(1,-1), c(-1,1), c(-1,-1), c(1,1))
y_test = matrix(c(1,1,1,1, -1, -1, -1, -1), 8, 1)
qp$fit(X_train, XStar, y_train)
y_predict = qp$predict(X_test)
print(y_predict)
correct = length(y_predict[y_predict == y_test,])
print("# correct predictions = ")
print(correct)
}
testSvmPlus()
library(svmplus)
testSvmPlus()
test3Class = function()
{
qp = svmPlus(cost = 1, gamma = 1,
kernel_x = "rbf", degree_x = 3, gamma_x = .0019,
kernel_xstar = "rbf", degree_xstar = 3, gamma_xstar = .0568,
tol = .00001)
X1 = rbind(c(3,1), c(3,-1), c(5,1), c(5,-1))
X2 = rbind(c(1,0), c(0,1), c(0,-1), c(-1,0))
X3 = rbind(c(10,10), c(10,11))
X_train = rbind(X1,X2)
X_train = rbind(X_train, X3)
y_train = matrix(c(1,1,1,1,2,2,2,2,3,3), 10, 1)
XStar = diag(10)
X_test = rbind(c(2,1), c(2,-1), c(6,1), c(6,-1),
c(1,-1), c(-1,1), c(-1,-1), c(1,1))
y_test = matrix(c(1,1,1,1, -1, -1, -1, -1), 8, 1)
qp$fit(X_train, XStar, y_train)
y_predict = qp$predict(X_test)
print(y_predict)
correct = length(y_predict[y_predict == y_test,])
print("# correct predictions = ")
print(correct)
}
test3Class()
test3Class()
library(svmplus)
test3Class()
a = c(1,2,3,1)
a[a != 1] = -1
a
a = c(1,2,3,1)
a[a==1] = 1
a[a != 1] = -1
a
X1 = rbind(c(3,1), c(3,-1), c(5,1), c(5,-1))
X2 = rbind(c(1,0), c(0,1), c(0,-1), c(-1,0))
X3 = rbind(c(10,10), c(10,11))
X_train = rbind(X1,X2)
X_train = rbind(X_train, X3)
plot(X_train)
X1 = rbind(c(3,1), c(3,-1), c(5,1), c(5,-1))
X2 = rbind(c(1,0), c(0,1), c(0,-1), c(-1,0))
X3 = rbind(c(6,10), c(8,11))
X_train = rbind(X1,X2)
X_train = rbind(X_train, X3)
plot(X_train)
X3 = rbind(c(4,10), c(6,11))
X_train = rbind(X1,X2)
X_train = rbind(X_train, X3)
plot(X_train)
library(svmplus)
test3Class = function()
{
qp = svmPlus(cost = 1, gamma = 1,
kernel_x = "rbf", degree_x = 3, gamma_x = .0019,
kernel_xstar = "rbf", degree_xstar = 3, gamma_xstar = .0568,
tol = .00001)
X1 = rbind(c(3,1), c(3,-1), c(5,1), c(5,-1))
X2 = rbind(c(1,0), c(0,1), c(0,-1), c(-1,0))
X3 = rbind(c(4,10), c(6,11))
X_train = rbind(X1,X2)
X_train = rbind(X_train, X3)
plot(X_train)
y_train = matrix(c(1,1,1,1,2,2,2,2,3,3), 10, 1)
XStar = diag(10)
X_test = rbind(c(2,1), c(2,-1), c(6,1), c(6,-1),
c(1,-1), c(-1,1), c(-1,-1), c(1,1))
y_test = matrix(c(1,1,1,1, -1, -1, -1, -1), 8, 1)
qp$fit(X_train, XStar, y_train)
y_predict = qp$predict(X_test)
print(y_predict)
correct = length(y_predict[y_predict == y_test,])
print("# correct predictions = ")
print(correct)
}
test3Class()
library(svmplus)
test3Class()
library(svmplus)
test3Class()
test3Class = function()
{
qp = svmPlus(cost = 1, gamma = 1,
kernel_x = "rbf", degree_x = 3, gamma_x = .0019,
kernel_xstar = "rbf", degree_xstar = 3, gamma_xstar = .0568,
tol = .00001)
X1 = rbind(c(3,1), c(3,-1), c(5,1), c(5,-1))
X2 = rbind(c(1,0), c(0,1), c(0,-1), c(-1,0))
X3 = rbind(c(4,10), c(6,11))
X_train = rbind(X1,X2)
X_train = rbind(X_train, X3)
plot(X_train)
y_train = matrix(c(1,1,1,1,2,2,2,2,3,3), 10, 1)
XStar = diag(10)
X_test = rbind(c(2,1), c(2,-1), c(6,1), c(6,-1),
c(1,-1), c(-1,1), c(-1,-1), c(1,1))
y_test = matrix(c(1,1,1,1, 2, 2, 2, 2), 8, 1)
qp$fit(X_train, XStar, y_train)
y_predict = qp$predict(X_test)
print(y_predict)
correct = length(y_predict[y_predict == y_test,])
print("# correct predictions = ")
print(correct)
}
test3Class()
library(svmplus)
test3Class()
library(svmplus)
library(svmplus)
test3Class()
library(svmplus)
test3Class()
test3Class = function()
{
qp = svmPlus(cost = 1, gamma = 1,
kernel_x = "rbf", degree_x = 3, gamma_x = .0019,
kernel_xstar = "rbf", degree_xstar = 3, gamma_xstar = .0568,
tol = .00001)
X1 = rbind(c(3,1), c(3,-1), c(5,1), c(5,-1))
X2 = rbind(c(1,0), c(0,1), c(0,-1), c(-1,0))
X3 = rbind(c(4,10), c(6,11))
X_train = rbind(X1,X2)
X_train = rbind(X_train, X3)
plot(X_train)
y_train = matrix(c(1,1,1,1,2,2,2,2,3,3), 10, 1)
XStar = diag(10)
X_test = rbind(c(2,1), c(2,-1), c(6,1), c(6,-1),
c(1,-1), c(-1,1), c(-1,-1), c(1,1))
y_test = matrix(c(1,1,1,1, 2, 2, 2, 2), 8, 1)
qp$fit(X_train, XStar, y_train)
y_predict = qp$predict(X_test)
#print(y_predict)
correct = length(y_predict[y_predict == y_test,])
print("# correct predictions = ")
print(correct)
y_predict = qp$predict(X_train)
correct = length(y_predict[y_predict == y_train,])
print("# correct predictions = ")
print(correct)
}
test3Class()
X1 = rbind(c(3,1), c(3,-1), c(5,1), c(5,-1))
X2 = rbind(c(1,0), c(0,1), c(0,-1), c(-1,0))
X3 = rbind(c(4,10), c(6,11))
X_train = rbind(X1,X2)
X_train = rbind(X_train, X3)
plot(X_train)
library(svmplus)
test3Class = function()
{
qp = svmPlus(cost = 1, gamma = 1,
kernel_x = "rbf", degree_x = 3, gamma_x = .0019,
kernel_xstar = "rbf", degree_xstar = 3, gamma_xstar = .0568,
tol = .00001)
X1 = rbind(c(3,1), c(3,-1), c(5,1), c(5,-1))
X2 = rbind(c(1,0), c(0,1), c(0,-1), c(-1,0))
X3 = rbind(c(1,10), c(3,11))
X_train = rbind(X1,X2)
X_train = rbind(X_train, X3)
plot(X_train)
y_train = matrix(c(1,1,1,1,2,2,2,2,3,3), 10, 1)
XStar = diag(10)
X_test = rbind(c(2,1), c(2,-1), c(6,1), c(6,-1),
c(1,-1), c(-1,1), c(-1,-1), c(1,1))
y_test = matrix(c(1,1,1,1, 2, 2, 2, 2), 8, 1)
qp$fit(X_train, XStar, y_train)
y_predict = qp$predict(X_test)
#print(y_predict)
correct = length(y_predict[y_predict == y_test,])
print("# correct predictions = ")
print(correct)
y_predict = qp$predict(X_train)
correct = length(y_predict[y_predict == y_train,])
print("# correct predictions = ")
print(correct)
}
test3Class()
test3Class = function()
{
qp = svmPlus(cost = 1, gamma = 1,
kernel_x = "rbf", degree_x = 3, gamma_x = .0019,
kernel_xstar = "rbf", degree_xstar = 3, gamma_xstar = .0568,
tol = .00001)
X1 = rbind(c(3,1), c(3,-1), c(5,1), c(5,-1))
X2 = rbind(c(1,0), c(0,1), c(0,-1), c(-1,0))
X3 = rbind(c(1,10), c(3,11))
X_train = rbind(X1,X2)
X_train = rbind(X_train, X3)
plot(X_train)
y_train = matrix(c(1,1,1,1,2,2,2,2,3,3), 10, 1)
XStar = diag(10)
X_test = rbind(c(3,0), c(5,0), c(4,0), c(4,1),
c(0, 0), c(-1,-2), c(1,2), c(1,-2))
y_test = matrix(c(1,1,1,1, 2, 2, 2, 2), 8, 1)
qp$fit(X_train, XStar, y_train)
y_predict = qp$predict(X_test)
#print(y_predict)
correct = length(y_predict[y_predict == y_test,])
print("# correct predictions = ")
print(correct)
#y_predict = qp$predict(X_train)
#correct = length(y_predict[y_predict == y_train,])
#print("# correct predictions = ")
#print(correct)
}
test3Class()
testSvmPlus = function()
{
#library(svmplus)
qp = svmPlus(cost = 1, gamma = 1,
kernel_x = "rbf", degree_x = 3, gamma_x = .0019,
kernel_xstar = "rbf", degree_xstar = 3, gamma_xstar = .0568,
tol = .00001)
#X = 2*diag(3)
#X_test = 3*diag(3)
#magic five matrix
X_train = rbind(c(17, 24,  1,  8, 15),
c(23,  5,  7, 14, 16),
c(4,  6, 13, 20, 22),
c(10, 12, 19, 21,  3),
c(11, 18, 25,  2,  9))
y_train = matrix(c(1, 1, -1, 1, -1), 5,1)
XStar = diag(5)
XStar[1, 1] = 1
XStar[2, 2] = 2
XStar[3, 3] = 3
XStar[4, 4] = 4
XStar[5,5] = 5
#or
X1 = rbind(c(3,1), c(3,-1), c(5,1), c(5,-1))
X2 = rbind(c(1,0), c(0,1), c(0,-1), c(-1,0))
X_train = rbind(X1,X2)
y_train = matrix(c(1,1,1,1,-1,-1,-1,-1), 8, 1)
XStar = diag(8)
X_test = rbind(c(2,1), c(2,-1), c(6,1), c(6,-1),
c(1,-1), c(-1,1), c(-1,-1), c(1,1))
y_test = matrix(c(1,1,1,1, -1, -1, -1, -1), 8, 1)
qp$fit(X_train, XStar, y_train)
y_predict = qp$predict(X_test)
print(y_predict)
correct = length(y_predict[y_predict == y_test,])
print("# correct predictions = ")
print(correct)
}
testSvmPlus()
demo_mnist = function()
{
#source("R/QPSvmPlus.R")
qp = QPSvmPlus$new(cost = 1, gamma = 1,
kernel_x = "rbf", degree_x = 3, gamma_x = .001,
kernel_xstar = "rbf", degree_xstar = 3, gamma_xstar = .001,
tol = .00001)
train_features = read.csv("data/mnistResizedData.csv")
nrow(train_features)
ncol(train_features)
train_Pfeatures = read.csv("data/mnistData.csv")
nrow(train_Pfeatures)
ncol(train_Pfeatures)
train_labels = read.csv("data/mnistLabel.csv")
nrow(train_labels)
ncol(train_labels)
X_train = rbind(train_features[1:10, ], train_features[2001:2011, ])
y_train = matrix(c(train_labels[1:10,1], train_labels[2001:2011,1]),
21,1)
XStar = rbind(train_Pfeatures[1:10, ], train_Pfeatures[2001:2011, ])
print(y_train)
X_test = rbind(train_features[101:200, ], train_features[2101:2200, ])
y_test = matrix(c(train_labels[101:200, 1], train_labels[2101:2200, 1]),
200,1)
qp$fit(X_train, XStar, y_train)
y_predict = qp$predict(X_test)
y_predict[y_predict == 0] = 1
print(length(y_predict[y_predict == y_test]))
}
demo_mnist()
#source("R/QPSvmPlus.R")
qp = QPSvmPlus$new(cost = 1, gamma = 1,
kernel_x = "rbf", degree_x = 3, gamma_x = .001,
kernel_xstar = "rbf", degree_xstar = 3, gamma_xstar = .001,
tol = .00001)
#source("R/QPSvmPlus.R")
qp = svmPlus(cost = 1, gamma = 1,
kernel_x = "rbf", degree_x = 3, gamma_x = .001,
kernel_xstar = "rbf", degree_xstar = 3, gamma_xstar = .001,
tol = .00001)
train_features = read.csv("data/mnistResizedData.csv")
getwd
getwd()
train_features = read.csv("../data/mnistResizedData.csv")
train_features = read.csv("../svm_backup/data/mnistResizedData.csv")
train_features = read.csv("../svm_backup/data/mnistResizedData.csv")
nrow(train_features)
ncol(train_features)
train_Pfeatures = read.csv("../svm_backup/data/mnistData.csv")
nrow(train_Pfeatures)
ncol(train_Pfeatures)
train_labels = read.csv("../svm_backup/data/mnistLabel.csv")
nrow(train_labels)
ncol(train_labels)
X_train = rbind(train_features[1:10, ], train_features[2001:2011, ])
y_train = matrix(c(train_labels[1:10,1], train_labels[2001:2011,1]),
21,1)
XStar = rbind(train_Pfeatures[1:10, ], train_Pfeatures[2001:2011, ])
print(y_train)
X_test = rbind(train_features[101:200, ], train_features[2101:2200, ])
y_test = matrix(c(train_labels[101:200, 1], train_labels[2101:2200, 1]),
200,1)
qp$fit(X_train, XStar, y_train)
X_train = rbind(train_features[1:10, ], train_features[2001:2010, ])
y_train = matrix(c(train_labels[1:10,1], train_labels[2001:2010,1]),
20,1)
XStar = rbind(train_Pfeatures[1:10, ], train_Pfeatures[2001:2010, ])
print(y_train)
X_test = rbind(train_features[101:200, ], train_features[2101:2200, ])
y_test = matrix(c(train_labels[101:200, 1], train_labels[2101:2200, 1]),
200,1)
qp$fit(X_train, XStar, y_train)
y_predict = qp$predict(X_test)
y_predict[y_predict == 0] = 1
print(length(y_predict[y_predict == y_test]))
X_train = rbind(train_features[1:11, ], train_features[2001:2010, ])
y_train = matrix(c(train_labels[1:11,1], train_labels[2001:2010,1]),
21,1)
XStar = rbind(train_Pfeatures[1:11, ], train_Pfeatures[2001:2010, ])
print(y_train)
X_test = rbind(train_features[101:200, ], train_features[2101:2200, ])
y_test = matrix(c(train_labels[101:200, 1], train_labels[2101:2200, 1]),
200,1)
qp$fit(X_train, XStar, y_train)
X_train = rbind(train_features[1:9, ], train_features[2001:2010, ])
y_train = matrix(c(train_labels[1:9,1], train_labels[2001:2010,1]),
19,1)
XStar = rbind(train_Pfeatures[1:9, ], train_Pfeatures[2001:2010, ])
print(y_train)
qp$fit(X_train, XStar, y_train)
X_train = rbind(train_features[1:11, ], train_features[2001:2010, ])
X_train = rbind(train_features[1:11, ], train_features[2001:2011, ])
y_train = matrix(c(train_labels[1:11,1], train_labels[2001:2011,1]),
22,1)
XStar = rbind(train_Pfeatures[1:11, ], train_Pfeatures[2001:2011, ])
print(y_train)
qp$fit(X_train, XStar, y_train)
y_predict = qp$predict(X_test)
y_predict[y_predict == 0] = 1
print(length(y_predict[y_predict == y_test]))
library(svmplus)
testSvmPlus = function()
{
#library(svmplus)
qp = svmPlus(cost = 1, gamma = 1,
kernel_x = "rbf", degree_x = 3, gamma_x = .0019,
kernel_xstar = "rbf", degree_xstar = 3, gamma_xstar = .0568,
tol = .00001)
#X = 2*diag(3)
#X_test = 3*diag(3)
#magic five matrix
X_train = rbind(c(17, 24,  1,  8, 15),
c(23,  5,  7, 14, 16),
c(4,  6, 13, 20, 22),
c(10, 12, 19, 21,  3),
c(11, 18, 25,  2,  9))
y_train = matrix(c(1, 1, -1, 1, -1), 5,1)
XStar = diag(5)
XStar[1, 1] = 1
XStar[2, 2] = 2
XStar[3, 3] = 3
XStar[4, 4] = 4
XStar[5,5] = 5
#or
X1 = rbind(c(3,1), c(3,-1), c(5,1), c(5,-1))
X2 = rbind(c(1,0), c(0,1), c(0,-1), c(-1,0))
X_train = rbind(X1,X2)
y_train = matrix(c(1,1,1,1,-1,-1,-1,-1), 8, 1)
XStar = diag(8)
X_test = rbind(c(2,1), c(2,-1), c(6,1), c(6,-1),
c(1,-1), c(-1,1), c(-1,-1), c(1,1))
y_test = matrix(c(1,1,1,1, -1, -1, -1, -1), 8, 1)
qp$fit(X_train, XStar, y_train)
y_predict = qp$predict(X_test)
print(y_predict)
correct = length(y_predict[y_predict == y_test,])
print("# correct predictions = ")
print(correct)
}
testSvmPlus = function()
{
#library(svmplus)
qp = svmPlus(cost = 1, gamma = 1,
kernel_x = "rbf", degree_x = 3, gamma_x = .0019,
kernel_xstar = "rbf", degree_xstar = 3, gamma_xstar = .0568,
tol = .00001)
#X = 2*diag(3)
#X_test = 3*diag(3)
#magic five matrix
X_train = rbind(c(17, 24,  1,  8, 15),
c(23,  5,  7, 14, 16),
c(4,  6, 13, 20, 22),
c(10, 12, 19, 21,  3),
c(11, 18, 25,  2,  9))
y_train = matrix(c(1, 1, -1, 1, -1), 5,1)
XStar = diag(5)
XStar[1, 1] = 1
XStar[2, 2] = 2
XStar[3, 3] = 3
XStar[4, 4] = 4
XStar[5,5] = 5
#or
X1 = rbind(c(3,1), c(3,-1), c(5,1), c(5,-1))
X2 = rbind(c(1,0), c(0,1), c(0,-1), c(-1,0))
X_train = rbind(X1,X2)
y_train = matrix(c(1,1,1,1,-1,-1,-1,-1), 8, 1)
XStar = diag(8)
X_test = rbind(c(2,1), c(2,-1), c(6,1), c(6,-1),
c(1,-1), c(-1,1), c(-1,-1), c(1,1))
y_test = matrix(c(1,1,1,1, -1, -1, -1, -1), 8, 1)
qp$fit(X_train, XStar, y_train)
y_predict = qp$predict(X_test)
print(y_predict)
correct = length(y_predict[y_predict == y_test,])
print("# correct predictions = ")
print(correct)
}
test3Class = function()
{
qp = svmPlus(cost = 1, gamma = 1,
kernel_x = "rbf", degree_x = 3, gamma_x = .0019,
kernel_xstar = "rbf", degree_xstar = 3, gamma_xstar = .0568,
tol = .00001)
X1 = rbind(c(3,1), c(3,-1), c(5,1), c(5,-1))
X2 = rbind(c(1,0), c(0,1), c(0,-1), c(-1,0))
X3 = rbind(c(1,10), c(3,11))
X_train = rbind(X1,X2)
X_train = rbind(X_train, X3)
plot(X_train)
y_train = matrix(c(1,1,1,1,2,2,2,2,3,3), 10, 1)
XStar = diag(10)
X_test = rbind(c(3,0), c(5,0), c(4,0), c(4,1),
c(0, 0), c(-1,-2), c(1,2), c(1,-2))
y_test = matrix(c(1,1,1,1, 2, 2, 2, 2), 8, 1)
qp$fit(X_train, XStar, y_train)
y_predict = qp$predict(X_test)
#print(y_predict)
correct = length(y_predict[y_predict == y_test,])
print("# correct predictions = ")
print(correct)
#y_predict = qp$predict(X_train)
#correct = length(y_predict[y_predict == y_train,])
#print("# correct predictions = ")
#print(correct)
}
demo_mnist = function()
{
#source("R/QPSvmPlus.R")
qp = svmPlus(cost = 1, gamma = 1,
kernel_x = "rbf", degree_x = 3, gamma_x = .001,
kernel_xstar = "rbf", degree_xstar = 3, gamma_xstar = .001,
tol = .00001)
train_features = read.csv("../svm_backup/data/mnistResizedData.csv")
nrow(train_features)
ncol(train_features)
train_Pfeatures = read.csv("../svm_backup/data/mnistData.csv")
nrow(train_Pfeatures)
ncol(train_Pfeatures)
train_labels = read.csv("../svm_backup/data/mnistLabel.csv")
nrow(train_labels)
ncol(train_labels)
X_train = rbind(train_features[1:11, ], train_features[2001:2011, ])
y_train = matrix(c(train_labels[1:11,1], train_labels[2001:2011,1]),
22,1)
XStar = rbind(train_Pfeatures[1:11, ], train_Pfeatures[2001:2011, ])
print(y_train)
X_test = rbind(train_features[101:200, ], train_features[2101:2200, ])
y_test = matrix(c(train_labels[101:200, 1], train_labels[2101:2200, 1]),
200,1)
qp$fit(X_train, XStar, y_train)
y_predict = qp$predict(X_test)
y_predict[y_predict == 0] = 1
print(length(y_predict[y_predict == y_test]))
}
testSvmPlus()
test3Class()
demo_mnist()
install.packages("quadprog")
install.packages("quadprog")
